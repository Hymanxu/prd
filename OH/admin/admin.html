<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理后台 - OpenHarmony 社区创新奖励计划</title>
    <!-- TDesign CSS -->
    <link rel="stylesheet" href="https://unpkg.com/tdesign-web@latest/dist/tdesign.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Admin专用样式 -->
    <link rel="stylesheet" href="admin.css">
</head>

<body>
    <div class="admin-layout">
        <!-- 侧边栏 -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <i class="fas fa-shield-alt"></i>
                    管理后台
                </div>
                <div style="font-size: 12px; color: #9CA3AF; margin-top: 4px;">
                    OpenHarmony社区创新奖励计划
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-group">
                    <div class="nav-group-title">竞赛管理</div>
                    <button class="nav-item active" data-section="events">
                        <i class="fas fa-calendar-alt"></i>
                        竞赛管理
                    </button>
                    <button class="nav-item" data-section="registrations">
                        <i class="fas fa-user-plus"></i>
                        报名管理
                    </button>
                    <button class="nav-item" data-section="settings">
                        <i class="fas fa-cog"></i>
                        网站管理
                    </button>
                </div>

                <div class="nav-group">
                    <div class="nav-group-title">赛题管理</div>
                    <button class="nav-item" data-section="problems">
                        <i class="fas fa-code"></i>
                        赛题管理
                    </button>
                    <button class="nav-item" data-section="submissions">
                        <i class="fas fa-upload"></i>
                        提交审核
                    </button>
                </div>

                <div class="nav-group">
                    <div class="nav-group-title">奖励管理</div>
                    <button class="nav-item" data-section="scoring">
                        <i class="fas fa-calculator"></i>
                        赛事结算
                    </button>
                    <button class="nav-item" data-section="certificates">
                        <i class="fas fa-certificate"></i>
                        证书发放
                    </button>
                    <button class="nav-item" data-section="templates">
                        <i class="fas fa-file-alt"></i>
                        证书模板
                    </button>
                </div>

                <div class="nav-group">
                    <div class="nav-group-title">系统管理</div>
                    <button class="nav-item" data-section="users">
                        <i class="fas fa-users"></i>
                        管理员账号
                    </button>
                </div>
            </nav>
        </aside>

        <!-- 主内容区域 -->
        <main class="main-content">
            <!-- 顶部导航 -->
            <header class="top-nav">
                <h1 class="page-title" id="pageTitle">竞赛管理</h1>
                <div class="user-menu">
                    <span>管理员</span>
                    <div class="user-avatar">A</div>
                    <button class="btn btn-outline btn-sm" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i>
                        退出
                    </button>
                </div>
            </header>

            <!-- 内容区域 -->
            <div class="content-area">
                <!-- 竞赛管理 -->
                <section id="events" class="content-section active">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">竞赛管理</h2>
                            <button class="btn btn-primary" onclick="openEventModal()">
                                <i class="fas fa-plus"></i>
                                创建竞赛
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="toolbar">
                                <div class="toolbar-left">
                                    <div class="search-box">
                                        <i class="fas fa-search"></i>
                                        <input type="text" class="form-control" placeholder="搜索竞赛名称...">
                                    </div>
                                </div>
                            </div>

                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>序号</th>
                                            <th>竞赛名称</th>
                                            <th>时间周期</th>
                                            <th>状态</th>
                                            <th>参赛人数</th>
                                            <th>赛题数量</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>1</td>
                                            <td>OpenHarmony 2025年1月安全挑战赛</td>
                                            <td>2025-01-01 ~ 2025-01-31</td>
                                            <td><span class="status-badge status-active">已发布</span></td>
                                            <td><a href="#" onclick="goToRegistrations(1)"
                                                    style="color: #3B82F6; text-decoration: none;">156</a></td>
                                            <td><a href="#" onclick="goToProblems(1)"
                                                    style="color: #3B82F6; text-decoration: none;">8</a></td>
                                            <td>
                                                <button class="btn btn-secondary btn-sm"
                                                    onclick="unpublishEvent(1)">取消发布</button>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editEvent(1)">编辑</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>2</td>
                                            <td>OpenHarmony 2025年2月安全挑战赛</td>
                                            <td>2025-02-01 ~ 2025-02-28</td>
                                            <td><span class="status-badge status-draft">草稿</span></td>
                                            <td><a href="#" onclick="goToRegistrations(2)"
                                                    style="color: #3B82F6; text-decoration: none;">0</a></td>
                                            <td><a href="#" onclick="goToProblems(2)"
                                                    style="color: #3B82F6; text-decoration: none;">0</a></td>
                                            <td>
                                                <button class="btn btn-success btn-sm"
                                                    onclick="publishEvent(2)">发布</button>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editEvent(2)">编辑</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 赛题管理 -->
                <section id="problems" class="content-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">赛题管理</h2>
                            <div>
                                <button class="btn btn-secondary" onclick="batchImportProblems()">
                                    <i class="fas fa-upload"></i>
                                    批量导入
                                </button>
                                <button class="btn btn-primary" onclick="openProblemModal()">
                                    <i class="fas fa-plus"></i>
                                    创建赛题
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="toolbar">
                                <div class="toolbar-left">
                                    <select class="form-control">
                                        <option>选择赛事</option>
                                        <option>2025年1月安全挑战赛</option>
                                        <option>2025年2月安全挑战赛</option>
                                    </select>
                                </div>
                                <div class="toolbar-right">
                                    <div class="search-box">
                                        <i class="fas fa-search"></i>
                                        <input type="text" class="form-control" placeholder="搜索赛题...">
                                    </div>
                                </div>
                            </div>

                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>赛题名称</th>
                                            <th>所属赛事</th>
                                            <th>难度</th>
                                            <th>Issue链接</th>
                                            <th>标签</th>
                                            <th>状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>OpenHarmony内核缓冲区溢出检测</td>
                                            <td>OpenHarmony 2025年1月安全挑战赛</td>
                                            <td><span class="status-badge status-pending">中等</span></td>
                                            <td><a href="https://github.com/example/issue/123" target="_blank"
                                                    style="color: #3B82F6;">#123</a></td>
                                            <td>
                                                <span class="status-badge"
                                                    style="background: #DBEAFE; color: #1E40AF;">内核</span>
                                                <span class="status-badge"
                                                    style="background: #FEE2E2; color: #991B1B;">缓冲区溢出</span>
                                            </td>
                                            <td><span class="status-badge status-active">已发布</span></td>
                                            <td>
                                                <button class="btn btn-secondary btn-sm"
                                                    onclick="unpublishProblem(1)">取消发布</button>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editProblem(1)">编辑</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>OpenHarmony权限提升漏洞分析</td>
                                            <td>OpenHarmony 2025年1月安全挑战赛</td>
                                            <td><span class="status-badge"
                                                    style="background: #FEE2E2; color: #991B1B;">困难</span></td>
                                            <td><a href="https://github.com/example/issue/124" target="_blank"
                                                    style="color: #3B82F6;">#124</a></td>
                                            <td>
                                                <span class="status-badge"
                                                    style="background: #F3E8FF; color: #7C3AED;">权限</span>
                                                <span class="status-badge"
                                                    style="background: #FEF3C7; color: #92400E;">提升</span>
                                            </td>
                                            <td><span class="status-badge status-draft">草稿</span></td>
                                            <td>
                                                <button class="btn btn-success btn-sm"
                                                    onclick="publishProblem(2)">发布</button>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editProblem(2)">编辑</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="registrations" class="content-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">报名管理</h2>
                            <div>
                                <button class="btn btn-secondary" onclick="exportRegistrations()">
                                    <i class="fas fa-download"></i>
                                    导出报名信息
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="toolbar">
                                <div class="toolbar-left">
                                    <select class="form-control">
                                        <option>选择赛事</option>
                                        <option>2025年1月安全挑战赛</option>
                                        <option>2025年2月安全挑战赛</option>
                                    </select>
                                </div>
                                <div class="toolbar-right">
                                    <div class="search-box">
                                        <i class="fas fa-search"></i>
                                        <input type="text" class="form-control" placeholder="搜索参赛者...">
                                    </div>
                                </div>
                            </div>

                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>用户名</th>
                                            <th>学校</th>
                                            <th>专业</th>
                                            <th>邮箱</th>
                                            <th>报名时间</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>张三</td>
                                            <td>清华大学</td>
                                            <td>计算机科学与技术</td>
                                            <td>zhangsan@example.com</td>
                                            <td>2025-01-15 14:30</td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="viewRegistrationDetail(1)">查看</button>
                                                <button class="btn btn-danger btn-sm"
                                                    onclick="removeRegistration(1)">移除</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>李四</td>
                                            <td>北京大学</td>
                                            <td>软件工程</td>
                                            <td>lisi@example.com</td>
                                            <td>2025-01-15 16:20</td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="viewRegistrationDetail(2)">查看</button>
                                                <button class="btn btn-danger btn-sm"
                                                    onclick="removeRegistration(2)">移除</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="pagination">
                                <button disabled>上一页</button>
                                <button class="active">1</button>
                                <button>2</button>
                                <button>3</button>
                                <button>下一页</button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="submissions" class="content-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">提交审核</h2>
                            <div>
                                <button class="btn btn-success" onclick="batchApproveSubmissions()">
                                    <i class="fas fa-check"></i>
                                    批量通过
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="toolbar">
                                <div class="toolbar-left">
                                    <select class="form-control">
                                        <option>选择赛题</option>
                                        <option>OpenHarmony内核缓冲区溢出检测</option>
                                        <option>OpenHarmony权限提升漏洞分析</option>
                                    </select>
                                </div>
                                <div class="toolbar-right">
                                    <select class="form-control">
                                        <option>全部状态</option>
                                        <option>待审核</option>
                                        <option>已通过</option>
                                        <option>已拒绝</option>
                                        <option>评测中</option>
                                    </select>
                                </div>
                            </div>

                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox" id="selectAllSubmissions"></th>
                                            <th>提交信息</th>
                                            <th>参赛者</th>
                                            <th>赛题</th>
                                            <th>提交时间</th>
                                            <th>类型</th>
                                            <th>得分</th>
                                            <th>状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><input type="checkbox" class="submission-select"></td>
                                            <td>
                                                <div style="font-weight: 500; font-family: monospace; color: #3B82F6;">
                                                    a7b3c9</div>
                                            </td>
                                            <td>张三</td>
                                            <td>OpenHarmony内核缓冲区溢出检测</td>
                                            <td>2025-01-15 14:30</td>
                                            <td><span class="status-badge"
                                                    style="background: #DBEAFE; color: #1E40AF;">覆盖率提升</span></td>
                                            <td>85</td>
                                            <td><span class="status-badge status-pending">待审核</span></td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="reviewSubmission(1)">审核</button>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="viewSubmissionDetail(1)">查看详情</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><input type="checkbox" class="submission-select"></td>
                                            <td>
                                                <div style="font-weight: 500; font-family: monospace; color: #3B82F6;">
                                                    f2e8d1</div>
                                            </td>
                                            <td>李四</td>
                                            <td>OpenHarmony权限提升漏洞分析</td>
                                            <td>2025-01-15 16:45</td>
                                            <td><span class="status-badge"
                                                    style="background: #FEE2E2; color: #991B1B;">0Day漏洞挖掘</span></td>
                                            <td>150</td>
                                            <td><span class="status-badge status-active">已通过</span></td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="reviewSubmission(2)">审核</button>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="viewSubmissionDetail(2)">查看详情</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="scoring" class="content-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">赛事结算</h2>
                            <div>
                                <button class="btn btn-secondary" onclick="exportScoring()">
                                    <i class="fas fa-download"></i>
                                    导出结算数据
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="toolbar">
                                <div class="toolbar-left">
                                    <select class="form-control">
                                        <option>选择赛事</option>
                                        <option>2025年1月安全挑战赛</option>
                                        <option>2025年2月安全挑战赛</option>
                                    </select>
                                </div>
                                <div class="toolbar-right">
                                    <select class="form-control">
                                        <option>全部用户</option>
                                        <option>收款信息已完善</option>
                                        <option>收款信息未完善</option>
                                    </select>
                                </div>
                            </div>

                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>排名</th>
                                            <th>用户名</th>
                                            <th>学校</th>
                                            <th>积分</th>
                                            <th>收款信息</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><span style="font-weight: 600; color: #F59E0B;">1</span></td>
                                            <td>张三</td>
                                            <td>清华大学</td>
                                            <td><span style="font-weight: 600; color: #3B82F6;">1,250</span></td>
                                            <td><span class="status-badge status-active">已完善</span></td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="viewScoreDetail(1)">详情</button>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="adjustScore(1)">调整</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><span style="font-weight: 600; color: #6B7280;">2</span></td>
                                            <td>李四</td>
                                            <td>北京大学</td>
                                            <td><span style="font-weight: 600; color: #3B82F6;">1,180</span></td>
                                            <td><span class="status-badge status-inactive">无</span></td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="viewScoreDetail(2)">详情</button>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="adjustScore(2)">调整</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="pagination">
                                <button disabled>上一页</button>
                                <button class="active">1</button>
                                <button>2</button>
                                <button>3</button>
                                <button>下一页</button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="certificates" class="content-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">发放规则</h2>
                            <div>
                                <button class="btn btn-secondary" onclick="openCertificateHistoryModal()">
                                    <i class="fas fa-history"></i>
                                    发放记录
                                </button>
                                <button class="btn btn-primary" onclick="openCertificateRuleModal()">
                                    <i class="fas fa-plus"></i>
                                    添加规则
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="toolbar">
                                <div class="toolbar-left">
                                    <select class="form-control">
                                        <option>全部赛事</option>
                                        <option>OpenHarmony 2025年1月安全挑战赛</option>
                                        <option>OpenHarmony 2025年2月安全挑战赛</option>
                                    </select>
                                </div>
                            </div>

                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>赛事</th>
                                            <th>发放条件</th>
                                            <th>证书</th>
                                            <th>状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>OpenHarmony 2025年1月安全挑战赛</td>
                                            <td>排名第1名</td>
                                            <td><span class="status-badge"
                                                    style="background: #FEF3C7; color: #92400E;">冠军证书</span></td>
                                            <td><span class="status-badge status-active">启用</span></td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editCertificateRule(1)">编辑</button>
                                                <button class="btn btn-secondary btn-sm"
                                                    onclick="disableRule(1)">关闭</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>OpenHarmony 2025年1月安全挑战赛</td>
                                            <td>排名第2-10名</td>
                                            <td><span class="status-badge"
                                                    style="background: #E5E7EB; color: #374151;">优秀奖证书</span></td>
                                            <td><span class="status-badge status-active">启用</span></td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editCertificateRule(2)">编辑</button>
                                                <button class="btn btn-secondary btn-sm"
                                                    onclick="disableRule(2)">关闭</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>OpenHarmony 2025年1月安全挑战赛</td>
                                            <td>完成至少1个赛题</td>
                                            <td><span class="status-badge"
                                                    style="background: #DBEAFE; color: #1E40AF;">参与证书</span></td>
                                            <td><span class="status-badge status-draft">关闭</span></td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editCertificateRule(3)">编辑</button>
                                                <button class="btn btn-success btn-sm"
                                                    onclick="enableRule(3)">启用</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="templates" class="content-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">证书模板</h2>
                            <button class="btn btn-primary" onclick="openTemplateModal()">
                                <i class="fas fa-plus"></i>
                                创建模板
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="toolbar">
                                <div class="toolbar-left">
                                    <div class="search-box">
                                        <i class="fas fa-search"></i>
                                        <input type="text" class="form-control" placeholder="搜索模板名称...">
                                    </div>
                                </div>
                            </div>

                            <div
                                style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                                <div class="card" style="margin: 0;">
                                    <div
                                        style="padding: 16px; text-align: center; background: linear-gradient(135deg, #FEF3C7 0%, #F59E0B 100%); color: #92400E;">
                                        <i class="fas fa-trophy" style="font-size: 32px; margin-bottom: 12px;"></i>
                                        <h3 style="margin: 0; font-size: 16px;">冠军证书模板</h3>
                                    </div>
                                    <div style="padding: 16px;">
                                        <div style="margin-bottom: 12px;">
                                            <div style="font-size: 12px; color: #6B7280;">创建时间</div>
                                            <div>2025-01-01</div>
                                        </div>
                                        <div style="margin-bottom: 12px;">
                                            <div style="font-size: 12px; color: #6B7280;">使用次数</div>
                                            <div>15次</div>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-outline btn-sm"
                                                onclick="previewTemplate(1)">预览</button>
                                            <button class="btn btn-outline btn-sm"
                                                onclick="uploadCertificateImage(1)">上传证书图片</button>
                                            <button class="btn btn-outline btn-sm"
                                                onclick="duplicateTemplate(1)">复制</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="card" style="margin: 0;">
                                    <div
                                        style="padding: 16px; text-align: center; background: linear-gradient(135deg, #E5E7EB 0%, #6B7280 100%); color: white;">
                                        <i class="fas fa-medal" style="font-size: 32px; margin-bottom: 12px;"></i>
                                        <h3 style="margin: 0; font-size: 16px;">优秀奖证书模板</h3>
                                    </div>
                                    <div style="padding: 16px;">
                                        <div style="margin-bottom: 12px;">
                                            <div style="font-size: 12px; color: #6B7280;">创建时间</div>
                                            <div>2025-01-01</div>
                                        </div>
                                        <div style="margin-bottom: 12px;">
                                            <div style="font-size: 12px; color: #6B7280;">使用次数</div>
                                            <div>32次</div>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-outline btn-sm"
                                                onclick="previewTemplate(2)">预览</button>
                                            <button class="btn btn-outline btn-sm"
                                                onclick="uploadCertificateImage(2)">上传证书图片</button>
                                            <button class="btn btn-outline btn-sm"
                                                onclick="duplicateTemplate(2)">复制</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="card" style="margin: 0;">
                                    <div
                                        style="padding: 16px; text-align: center; background: linear-gradient(135deg, #DBEAFE 0%, #3B82F6 100%); color: white;">
                                        <i class="fas fa-certificate" style="font-size: 32px; margin-bottom: 12px;"></i>
                                        <h3 style="margin: 0; font-size: 16px;">参与证书模板</h3>
                                    </div>
                                    <div style="padding: 16px;">
                                        <div style="margin-bottom: 12px;">
                                            <div style="font-size: 12px; color: #6B7280;">创建时间</div>
                                            <div>2025-01-01</div>
                                        </div>
                                        <div style="margin-bottom: 12px;">
                                            <div style="font-size: 12px; color: #6B7280;">使用次数</div>
                                            <div>128次</div>
                                        </div>
                                        <div style="display: flex; gap: 8px;">
                                            <button class="btn btn-outline btn-sm"
                                                onclick="previewTemplate(3)">预览</button>
                                            <button class="btn btn-outline btn-sm"
                                                onclick="uploadCertificateImage(3)">上传证书图片</button>
                                            <button class="btn btn-outline btn-sm"
                                                onclick="duplicateTemplate(3)">复制</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="users" class="content-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">管理员账号</h2>
                            <button class="btn btn-primary" onclick="openAddAdminModal()">
                                <i class="fas fa-plus"></i>
                                添加管理员
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="toolbar">
                                <div class="toolbar-left">
                                    <select class="form-control">
                                        <option>全部角色</option>
                                        <option>管理员</option>
                                        <option>运营</option>
                                        <option>审核</option>
                                        <option>出题人</option>
                                    </select>
                                </div>
                                <div class="toolbar-right">
                                    <div class="search-box">
                                        <i class="fas fa-search"></i>
                                        <input type="text" class="form-control" placeholder="搜索管理员...">
                                    </div>
                                </div>
                            </div>

                            <div class="table-container">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>姓名</th>
                                            <th>手机号</th>
                                            <th>角色</th>
                                            <th>状态</th>
                                            <th>创建时间</th>
                                            <th>最后登录</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>系统管理员</td>
                                            <td>138****0001</td>
                                            <td><span class="status-badge"
                                                    style="background: #FEE2E2; color: #991B1B;">管理员</span></td>
                                            <td><span class="status-badge status-active">正常</span></td>
                                            <td>2025-01-01 00:00</td>
                                            <td>2025-01-15 09:30</td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editAdmin(1)">编辑</button>
                                                <button class="btn btn-secondary btn-sm"
                                                    onclick="disableAdmin(1)">禁用</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>运营专员</td>
                                            <td>139****0002</td>
                                            <td><span class="status-badge"
                                                    style="background: #DBEAFE; color: #1E40AF;">运营</span></td>
                                            <td><span class="status-badge status-active">正常</span></td>
                                            <td>2025-01-05 10:00</td>
                                            <td>2025-01-15 14:20</td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editAdmin(2)">编辑</button>
                                                <button class="btn btn-secondary btn-sm"
                                                    onclick="disableAdmin(2)">禁用</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>审核专员</td>
                                            <td>137****0003</td>
                                            <td><span class="status-badge"
                                                    style="background: #FEF3C7; color: #92400E;">审核</span></td>
                                            <td><span class="status-badge status-inactive">禁用</span></td>
                                            <td>2025-01-08 15:30</td>
                                            <td>2025-01-12 16:45</td>
                                            <td>
                                                <button class="btn btn-outline btn-sm"
                                                    onclick="editAdmin(3)">编辑</button>
                                                <button class="btn btn-success btn-sm"
                                                    onclick="enableAdmin(3)">启用</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="settings" class="content-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">网站配置</h2>
                        </div>
                        <div class="card-body" style="padding: 0;">
                            <!-- Tab导航 -->
                            <div style="border-bottom: 1px solid #E5E7EB;">
                                <div style="display: flex; padding: 0 24px;">
                                    <button class="config-tab active" data-tab="banner"
                                        onclick="switchConfigTab('banner')">
                                        <i class="fas fa-image" style="margin-right: 8px;"></i>首页Banner
                                    </button>
                                    <button class="config-tab" data-tab="introduction"
                                        onclick="switchConfigTab('introduction')">
                                        <i class="fas fa-file-alt" style="margin-right: 8px;"></i>大赛介绍
                                    </button>
                                    <button class="config-tab" data-tab="notices" onclick="switchConfigTab('notices')">
                                        <i class="fas fa-bullhorn" style="margin-right: 8px;"></i>通知公告
                                    </button>
                                    <button class="config-tab" data-tab="faq" onclick="switchConfigTab('faq')">
                                        <i class="fas fa-question-circle" style="margin-right: 8px;"></i>常见问题
                                    </button>
                                </div>
                            </div>

                            <!-- Tab内容 -->
                            <div style="padding: 24px;">
                                <!-- Banner配置 -->
                                <div id="banner-config" class="config-content active">
                                    <div style="margin-bottom: 20px;">
                                        <h3 style="font-size: 16px; margin-bottom: 16px;">首页Banner管理</h3>
                                        <button class="btn btn-primary" onclick="addBannerImage()">
                                            <i class="fas fa-plus"></i>
                                            添加Banner图片
                                        </button>
                                    </div>

                                    <div
                                        style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                                        <div class="card" style="margin: 0;">
                                            <div style="position: relative;">
                                                <img src="https://via.placeholder.com/300x150/3B82F6/FFFFFF?text=Banner+1"
                                                    style="width: 100%; height: 150px; object-fit: cover; border-radius: 8px 8px 0 0;">
                                                <div
                                                    style="position: absolute; top: 8px; right: 8px; display: flex; gap: 4px;">
                                                    <button class="btn btn-outline btn-sm" onclick="editBannerImage(1)"
                                                        style="background: rgba(255,255,255,0.9);">编辑</button>
                                                    <button class="btn btn-danger btn-sm" onclick="deleteBannerImage(1)"
                                                        style="background: rgba(239,68,68,0.9); color: white;">删除</button>
                                                </div>
                                            </div>
                                            <div style="padding: 16px;">
                                                <div style="font-weight: 500; margin-bottom: 8px;">主Banner图片</div>
                                                <div style="font-size: 12px; color: #6B7280; margin-bottom: 8px;">
                                                    1920x1080 • 上传时间：2025-01-01</div>
                                                <div style="display: flex; align-items: center; gap: 8px;">
                                                    <span class="status-badge status-active">启用</span>
                                                    <button class="btn btn-outline btn-sm"
                                                        onclick="toggleBannerStatus(1)">禁用</button>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="card" style="margin: 0;">
                                            <div style="position: relative;">
                                                <img src="https://via.placeholder.com/300x150/10B981/FFFFFF?text=Banner+2"
                                                    style="width: 100%; height: 150px; object-fit: cover; border-radius: 8px 8px 0 0;">
                                                <div
                                                    style="position: absolute; top: 8px; right: 8px; display: flex; gap: 4px;">
                                                    <button class="btn btn-outline btn-sm" onclick="editBannerImage(2)"
                                                        style="background: rgba(255,255,255,0.9);">编辑</button>
                                                    <button class="btn btn-danger btn-sm" onclick="deleteBannerImage(2)"
                                                        style="background: rgba(239,68,68,0.9); color: white;">删除</button>
                                                </div>
                                            </div>
                                            <div style="padding: 16px;">
                                                <div style="font-weight: 500; margin-bottom: 8px;">活动Banner图片</div>
                                                <div style="font-size: 12px; color: #6B7280; margin-bottom: 8px;">
                                                    1920x1080 • 上传时间：2025-01-10</div>
                                                <div style="display: flex; align-items: center; gap: 8px;">
                                                    <span class="status-badge status-draft">禁用</span>
                                                    <button class="btn btn-success btn-sm"
                                                        onclick="toggleBannerStatus(2)">启用</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 大赛介绍配置 -->
                                <div id="introduction-config" class="config-content">
                                    <div style="margin-bottom: 20px;"></div>
                                    <h3 style="font-size: 16px; margin-bottom: 16px;">大赛介绍编辑</h3>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">介绍内容</label>
                                    <div
                                        style="border: 1px solid #D1D5DB; border-radius: 6px; min-height: 300px; padding: 12px;">
                                        <div
                                            style="border-bottom: 1px solid #E5E7EB; padding-bottom: 8px; margin-bottom: 12px;">
                                            <button class="btn btn-outline btn-sm" onclick="formatText('bold')"><i
                                                    class="fas fa-bold"></i></button>
                                            <button class="btn btn-outline btn-sm" onclick="formatText('italic')"><i
                                                    class="fas fa-italic"></i></button>
                                            <button class="btn btn-outline btn-sm" onclick="formatText('underline')"><i
                                                    class="fas fa-underline"></i></button>
                                            <button class="btn btn-outline btn-sm" onclick="insertLink()"><i
                                                    class="fas fa-link"></i></button>
                                            <button class="btn btn-outline btn-sm" onclick="insertImage()"><i
                                                    class="fas fa-image"></i></button>
                                        </div>
                                        <div contenteditable="true"
                                            style="min-height: 200px; outline: none; line-height: 1.6;">
                                            <h2>OpenHarmony 社区创新奖励计划</h2>
                                            <p>OpenHarmony 社区创新奖励计划旨在通过竞赛形式发现和修复 OpenHarmony 系统中的安全漏洞，提升系统整体安全性。</p>
                                            <h3>参赛对象</h3>
                                            <ul>
                                                <li>全国高等院校在校学生</li>
                                                <li>安全研究人员</li>
                                                <li>开发者社区成员</li>
                                            </ul>
                                            <h3>奖励机制</h3>
                                            <p>根据漏洞严重程度和代码质量，提供丰厚的现金奖励和荣誉证书。</p>
                                        </div>
                                    </div>
                                    <div style="margin-top: 12px;">
                                        <button class="btn btn-primary" onclick="saveIntroduction()">保存介绍</button>
                                        <button class="btn btn-outline" onclick="previewIntroduction()">预览</button>
                                    </div>
                                </div>
                            </div>

                            <!-- 通知公告配置 -->
                            <div id="notices-config" class="config-content">
                                <div style="margin-bottom: 20px;">
                                    <h3 style="font-size: 16px; margin-bottom: 16px;">通知公告管理</h3>
                                    <button class="btn btn-primary" onclick="addNotice()">
                                        <i class="fas fa-plus"></i>
                                        发布新公告
                                    </button>
                                </div>

                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>标题</th>
                                                <th>发布时间</th>
                                                <th>状态</th>
                                                <th>浏览量</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <div style="font-weight: 500;">2025年1月赛事开始报名</div>
                                                    <div style="font-size: 12px; color: #6B7280;">OpenHarmony
                                                        2025年1月安全挑战赛正式开始报名...</div>
                                                </td>
                                                <td>2025-01-15 10:00</td>
                                                <td><span class="status-badge status-active">已发布</span></td>
                                                <td>1,234</td>
                                                <td>
                                                    <button class="btn btn-outline btn-sm"
                                                        onclick="editNotice(1)">编辑</button>
                                                    <button class="btn btn-secondary btn-sm"
                                                        onclick="unpublishNotice(1)">下线</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div style="font-weight: 500;">竞赛规则更新说明</div>
                                                    <div style="font-size: 12px; color: #6B7280;">
                                                        为了更好地规范竞赛流程，现对竞赛规则进行更新...</div>
                                                </td>
                                                <td>2025-01-10 15:30</td>
                                                <td><span class="status-badge status-active">已发布</span></td>
                                                <td>856</td>
                                                <td>
                                                    <button class="btn btn-outline btn-sm"
                                                        onclick="editNotice(2)">编辑</button>
                                                    <button class="btn btn-secondary btn-sm"
                                                        onclick="unpublishNotice(2)">下线</button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- 常见问题配置 -->
                            <div id="faq-config" class="config-content">
                                <div style="margin-bottom: 20px;">
                                    <h3 style="font-size: 16px; margin-bottom: 16px;">常见问题管理</h3>
                                    <button class="btn btn-primary" onclick="addFAQ()">
                                        <i class="fas fa-plus"></i>
                                        添加问题
                                    </button>
                                </div>

                                <div class="table-container">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>问题</th>
                                                <th>分类</th>
                                                <th>更新时间</th>
                                                <th>状态</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <div style="font-weight: 500;">如何参加竞赛？</div>
                                                    <div style="font-size: 12px; color: #6B7280;">
                                                        参赛者需要先注册账号，然后选择相应的竞赛项目...</div>
                                                </td>
                                                <td><span class="status-badge"
                                                        style="background: #DBEAFE; color: #1E40AF;">报名相关</span></td>
                                                <td>2025-01-10 14:20</td>
                                                <td><span class="status-badge status-active">显示</span></td>
                                                <td>
                                                    <button class="btn btn-outline btn-sm"
                                                        onclick="editFAQ(1)">编辑</button>
                                                    <button class="btn btn-secondary btn-sm"
                                                        onclick="hideFAQ(1)">隐藏</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div style="font-weight: 500;">奖励如何发放？</div>
                                                    <div style="font-size: 12px; color: #6B7280;">
                                                        奖励将在竞赛结束后的3个工作日内发放到参赛者绑定的银行账户...</div>
                                                </td>
                                                <td><span class="status-badge"
                                                        style="background: #FEF3C7; color: #92400E;">奖励相关</span></td>
                                                <td>2025-01-08 16:45</td>
                                                <td><span class="status-badge status-active">显示</span></td>
                                                <td>
                                                    <button class="btn btn-outline btn-sm"
                                                        onclick="editFAQ(2)">编辑</button>
                                                    <button class="btn btn-secondary btn-sm"
                                                        onclick="hideFAQ(2)">隐藏</button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
            </div>
    </div>
    </section>td>
    </div>
    </main>
    </div>

    <!-- 竞赛编辑模态框 -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">编辑竞赛</h3>
                <button class="modal-close" onclick="closeEventModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="eventForm">
                    <div class="form-group">
                        <label class="form-label">竞赛名称</label>
                        <input type="text" class="form-control" name="name" required>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">开始时间</label>
                            <input type="datetime-local" class="form-control" name="start_time" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">结束时间</label>
                            <input type="datetime-local" class="form-control" name="end_time" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">竞赛主题</label>
                        <textarea class="form-control textarea" name="theme" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">竞赛类型</label>
                        <select class="form-control" name="type" required>
                            <option value="fuzzing">Fuzzing</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeEventModal()">取消</button>
                <button class="btn btn-primary" onclick="saveEvent()">保存</button>
            </div>
        </div>
    </div>

    <!-- 赛题编辑模态框 -->
    <div id="problemModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">编辑赛题</h3>
                <button class="modal-close" onclick="closeProblemModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="problemForm">
                    <div class="form-group">
                        <label class="form-label">赛题名称</label>
                        <input type="text" class="form-control" name="name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">难度</label>
                        <select class="form-control" name="difficulty" required>
                            <option value="easy">简单</option>
                            <option value="medium">中等</option>
                            <option value="hard">困难</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Issue链接</label>
                        <input type="url" class="form-control" name="issue_url"
                            placeholder="https://github.com/example/issue/123">
                    </div>
                    <div class="form-group">
                        <label class="form-label">说明</label>
                        <textarea class="form-control textarea" name="description" rows="6"
                            placeholder="支持富文本格式"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">标签</label>
                        <input type="text" class="form-control" name="tags" placeholder="用逗号分隔多个标签">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeProblemModal()">取消</button>
                <button class="btn btn-primary" onclick="saveProblem()">保存</button>
            </div>
        </div>
    </div>

    <!-- 提交审核模态框 -->
    <div id="reviewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">提交审核</h3>
                <button class="modal-close" onclick="closeReviewModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">提交信息</label>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px; margin-bottom: 16px;">
                        <div><strong>Commit ID:</strong> <span id="reviewCommitId">a7b3c9</span></div>
                        <div><strong>参赛者:</strong> <span id="reviewUser">张三</span></div>
                        <div><strong>赛题:</strong> <span id="reviewProblem">OpenHarmony内核缓冲区溢出检测</span></div>
                        <div><strong>提交时间:</strong> <span id="reviewTime">2025-01-15 14:30</span></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">系统评判信息</label>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px; margin-bottom: 16px;">
                        <div><strong>类型:</strong> 覆盖率提升</div>
                        <div><strong>自动评分:</strong> 85分</div>
                        <div><strong>编译状态:</strong> 成功</div>
                        <div><strong>测试结果:</strong> 通过 8/10 个测试用例</div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">审核结果</label>
                    <select class="form-control" id="reviewResult">
                        <option value="approved">通过</option>
                        <option value="rejected">拒绝</option>
                        <option value="pending">待定</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">审核意见</label>
                    <textarea class="form-control textarea" id="reviewComment" rows="4"
                        placeholder="请输入审核意见..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeReviewModal()">取消</button>
                <button class="btn btn-primary" onclick="submitReview()">提交审核</button>
            </div>
        </div>
    </div>

    <!-- 提交详情模态框 -->
    <div id="submissionDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">提交详情</h3>
                <button class="modal-close" onclick="closeSubmissionDetailModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">基本信息</label>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px; margin-bottom: 16px;">
                        <div><strong>Commit ID:</strong> <span id="detailCommitId">a7b3c9</span></div>
                        <div><strong>参赛者:</strong> <span id="detailUser">张三</span></div>
                        <div><strong>赛题:</strong> <span id="detailProblem">OpenHarmony内核缓冲区溢出检测</span></div>
                        <div><strong>提交时间:</strong> <span id="detailTime">2025-01-15 14:30</span></div>
                        <div><strong>类型:</strong> <span id="detailType">覆盖率提升</span></div>
                        <div><strong>得分:</strong> <span id="detailScore">85</span></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">系统评判流程</label>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px; margin-bottom: 16px;">
                        <div style="margin-bottom: 8px;">
                            <span style="color: #10B981;">✓</span> 代码编译检查 - 通过
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="color: #10B981;">✓</span> 静态代码分析 - 通过
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="color: #10B981;">✓</span> 单元测试执行 - 8/10 通过
                        </div>
                        <div style="margin-bottom: 8px;">
                            <span style="color: #10B981;">✓</span> 覆盖率分析 - 提升12%
                        </div>
                        <div>
                            <span style="color: #F59E0B;">⚠</span> 性能测试 - 待执行
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">审核信息</label>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                        <div><strong>审核状态:</strong> 待审核</div>
                        <div><strong>审核员:</strong> 未分配</div>
                        <div><strong>审核时间:</strong> -</div>
                        <div><strong>审核意见:</strong> -</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeSubmissionDetailModal()">关闭</button>
            </div>
        </div>
    </div>

    <!-- 证书发放规则模态框 -->
    <div id="certificateRuleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">添加证书发放规则</h3>
                <button class="modal-close" onclick="closeCertificateRuleModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="certificateRuleForm">
                    <div class="form-group">
                        <label class="form-label">选择赛事</label>
                        <div
                            style="border: 1px solid #D1D5DB; border-radius: 6px; padding: 12px; max-height: 120px; overflow-y: auto;">
                            <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <input type="checkbox" name="event_ids" value="1">
                                <span>OpenHarmony 2025年1月安全挑战赛</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <input type="checkbox" name="event_ids" value="2">
                                <span>OpenHarmony 2025年2月安全挑战赛</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="event_ids" value="3">
                                <span>OpenHarmony 2025年3月安全挑战赛</span>
                            </label>
                        </div>
                        <div style="font-size: 12px; color: #6B7280; margin-top: 4px;">
                            可选择多个赛事应用相同规则
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">发放条件</label>
                        <select class="form-control" name="condition_type" required
                            onchange="toggleConditionInput(this.value)">
                            <option value="">请选择条件类型</option>
                            <option value="rank">按排名</option>
                            <option value="score">按积分</option>
                            <option value="completion">按完成情况</option>
                        </select>
                    </div>
                    <div class="form-group" id="rankCondition" style="display: none;">
                        <label class="form-label">排名范围</label>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <input type="number" class="form-control" name="rank_start" placeholder="起始排名" min="1">
                            <span>至</span>
                            <input type="number" class="form-control" name="rank_end" placeholder="结束排名" min="1">
                        </div>
                    </div>
                    <div class="form-group" id="scoreCondition" style="display: none;">
                        <label class="form-label">最低积分</label>
                        <input type="number" class="form-control" name="min_score" placeholder="最低积分要求" min="0">
                    </div>
                    <div class="form-group" id="completionCondition" style="display: none;">
                        <label class="form-label">完成要求</label>
                        <input type="number" class="form-control" name="min_problems" placeholder="最少完成赛题数" min="1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">证书模板</label>
                        <select class="form-control" name="template_id" required>
                            <option value="">请选择证书模板</option>
                            <option value="1">冠军证书模板</option>
                            <option value="2">优秀奖证书模板</option>
                            <option value="3">参与证书模板</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeCertificateRuleModal()">取消</button>
                <button class="btn btn-primary" onclick="saveCertificateRule()">保存规则</button>
            </div>
        </div>
    </div>

    <!-- 证书模板编辑模态框 -->
    <div id="templateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">编辑证书模板</h3>
                <button class="modal-close" onclick="closeTemplateModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="templateForm">
                    <div class="form-group">
                        <label class="form-label">模板名称</label>
                        <input type="text" class="form-control" name="name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">证书类型</label>
                        <select class="form-control" name="type" required>
                            <option value="champion">冠军证书</option>
                            <option value="excellence">优秀奖证书</option>
                            <option value="participation">参与证书</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">证书标题</label>
                        <input type="text" class="form-control" name="title" placeholder="例如：OpenHarmony 社区创新奖励计划冠军证书">
                    </div>
                    <div class="form-group">
                        <label class="form-label">证书内容模板</label>
                        <textarea class="form-control textarea" name="content" rows="6"
                            placeholder="使用 {name}、{event}、{rank} 等变量"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">背景图片</label>
                        <input type="file" class="form-control" name="background" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label class="form-label">签名图片</label>
                        <input type="file" class="form-control" name="signature" accept="image/*">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeTemplateModal()">取消</button>
                <button class="btn btn-primary" onclick="saveTemplate()">保存模板</button>
            </div>
        </div>
    </div>

    <!-- 报名详情模态框 -->
    <div id="registrationDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">报名详情</h3>
                <button class="modal-close" onclick="closeRegistrationDetailModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">基本信息</label>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px; margin-bottom: 16px;">
                        <div><strong>用户名:</strong> <span id="regDetailName">张三</span></div>
                        <div><strong>学号:</strong> <span id="regDetailStudentId">2021012345</span></div>
                        <div><strong>学校:</strong> <span id="regDetailSchool">清华大学</span></div>
                        <div><strong>专业:</strong> <span id="regDetailMajor">计算机科学与技术</span></div>
                        <div><strong>邮箱:</strong> <span id="regDetailEmail">zhangsan@example.com</span></div>
                        <div><strong>手机:</strong> <span id="regDetailPhone">138****1234</span></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">报名信息</label>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px; margin-bottom: 16px;">
                        <div><strong>报名赛事:</strong> <span id="regDetailEvent">OpenHarmony 2025年1月安全挑战赛</span></div>
                        <div><strong>报名时间:</strong> <span id="regDetailTime">2025-01-15 14:30</span></div>
                        <div><strong>报名状态:</strong> <span id="regDetailStatus">已确认</span></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">技能标签</label>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px;">
                        <span class="status-badge"
                            style="background: #DBEAFE; color: #1E40AF; margin-right: 8px;">C/C++</span>
                        <span class="status-badge"
                            style="background: #FEE2E2; color: #991B1B; margin-right: 8px;">安全测试</span>
                        <span class="status-badge" style="background: #F3E8FF; color: #7C3AED;">Fuzzing</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeRegistrationDetailModal()">关闭</button>
            </div>
        </div>
    </div>

    <!-- 积分详情模态框 -->
    <div id="scoreDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">积分详情</h3>
                <button class="modal-close" onclick="closeScoreDetailModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">参赛者信息</label>
                    <div style="background: #F9FAFB; padding: 12px; border-radius: 6px; margin-bottom: 16px;">
                        <div><strong>用户名:</strong> <span id="scoreDetailName">张三</span></div>
                        <div><strong>学校:</strong> <span id="scoreDetailSchool">清华大学</span></div>
                        <div><strong>当前排名:</strong> <span id="scoreDetailRank">第1名</span></div>
                        <div><strong>总积分:</strong> <span id="scoreDetailTotal">1,250</span></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">收款信息</label>
                    <div style="background: #F9FAFB; padding: 16px; border-radius: 6px;">
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6B7280; margin-bottom: 4px;">银行卡信息</div>
                            <div><strong>开户银行:</strong> 中国工商银行</div>
                            <div><strong>卡号:</strong> 6222 **** **** 1234</div>
                            <div><strong>开户姓名:</strong> 张三</div>
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="font-size: 12px; color: #6B7280; margin-bottom: 4px;">联系方式</div>
                            <div><strong>手机号:</strong> 138****1234</div>
                            <div><strong>邮箱:</strong> zhangsan@example.com</div>
                        </div>
                        <div>
                            <div style="font-size: 12px; color: #6B7280; margin-bottom: 4px;">完善状态</div>
                            <div><span class="status-badge status-active">信息已完善</span></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeScoreDetailModal()">关闭</button>
            </div>
        </div>
    </div>

    <!-- 积分调整模态框 -->
    <div id="scoreAdjustModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">积分调整</h3>
                <button class="modal-close" onclick="closeScoreAdjustModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="scoreAdjustForm">
                    <div class="form-group">
                        <label class="form-label">参赛者</label>
                        <input type="text" class="form-control" id="adjustUserName" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">当前积分</label>
                        <input type="text" class="form-control" id="adjustCurrentScore" readonly>
                    </div>
                    <div class="form-group">
                        <label class="form-label">调整类型</label>
                        <select class="form-control" name="adjust_type" required>
                            <option value="add">增加积分</option>
                            <option value="subtract">减少积分</option>
                            <option value="set">设置积分</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">调整数值</label>
                        <input type="number" class="form-control" name="adjust_value" required min="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">调整原因</label>
                        <textarea class="form-control textarea" name="adjust_reason" rows="3" required
                            placeholder="请输入调整原因..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeScoreAdjustModal()">取消</button>
                <button class="btn btn-primary" onclick="submitScoreAdjust()">确认调整</button>
            </div>
        </div>
    </div>

    <!-- 证书发放记录模态框 -->
    <div id="certificateHistoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">证书发放记录</h3>
                <button class="modal-close" onclick="closeCertificateHistoryModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="toolbar" style="margin-bottom: 20px;">
                    <div class="toolbar-left">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" class="form-control" placeholder="搜索姓名...">
                        </div>
                    </div>
                    <div class="toolbar-right">
                        <select class="form-control">
                            <option>全部赛事</option>
                            <option>OpenHarmony 2025年1月安全挑战赛</option>
                            <option>OpenHarmony 2025年2月安全挑战赛</option>
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>姓名</th>
                                <th>赛事</th>
                                <th>排名</th>
                                <th>证书</th>
                                <th>发放时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>张三</td>
                                <td>OpenHarmony 2025年1月安全挑战赛</td>
                                <td>第1名</td>
                                <td><span class="status-badge" style="background: #FEF3C7; color: #92400E;">冠军证书</span>
                                </td>
                                <td>2025-01-31 10:00</td>
                            </tr>
                            <tr>
                                <td>李四</td>
                                <td>OpenHarmony 2025年1月安全挑战赛</td>
                                <td>第2名</td>
                                <td><span class="status-badge" style="background: #E5E7EB; color: #374151;">优秀奖证书</span>
                                </td>
                                <td>2025-01-31 10:05</td>
                            </tr>
                            <tr>
                                <td>王五</td>
                                <td>OpenHarmony 2025年1月安全挑战赛</td>
                                <td>第3名</td>
                                <td><span class="status-badge" style="background: #E5E7EB; color: #374151;">优秀奖证书</span>
                                </td>
                                <td>2025-01-31 10:05</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeCertificateHistoryModal()">关闭</button>
            </div>
        </div>
    </div>

    <!-- 上传证书图片模态框 -->
    <div id="uploadCertificateModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title">上传证书图片</h3>
                <button class="modal-close" onclick="closeUploadCertificateModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">证书背景图片</label>
                    <input type="file" class="form-control" accept="image/*" onchange="previewCertificateImage(this)">
                    <div style="font-size: 12px; color: #6B7280; margin-top: 4px;">
                        支持 JPG、PNG 格式，建议尺寸 1920x1080
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">图片预览与文字位置设置</label>
                    <div id="certificatePreview"
                        style="border: 2px dashed #D1D5DB; border-radius: 8px; padding: 20px; text-align: center; background: #F9FAFB; position: relative; min-height: 400px;">
                        <div id="previewPlaceholder">
                            <i class="fas fa-image" style="font-size: 48px; color: #9CA3AF; margin-bottom: 16px;"></i>
                            <div style="color: #6B7280;">请上传证书背景图片</div>
                        </div>
                        <img id="previewImage" style="max-width: 100%; max-height: 350px; display: none;">

                        <!-- 可拖拽的文字框 -->
                        <div id="textOverlays"
                            style="position: absolute; top: 20px; left: 20px; width: calc(100% - 40px); height: calc(100% - 40px); display: none;">
                            <div class="text-overlay" data-field="event"
                                style="position: absolute; top: 15%; left: 50%; transform: translateX(-50%); background: rgba(59, 130, 246, 0.8); color: white; padding: 6px 12px; border-radius: 4px; cursor: move; font-size: 14px; user-select: none;">
                                赛事名称
                            </div>
                            <div class="text-overlay" data-field="name"
                                style="position: absolute; top: 35%; left: 50%; transform: translateX(-50%); background: rgba(59, 130, 246, 0.8); color: white; padding: 6px 12px; border-radius: 4px; cursor: move; font-size: 14px; user-select: none;">
                                姓名
                            </div>
                            <div class="text-overlay" data-field="award"
                                style="position: absolute; top: 55%; left: 50%; transform: translateX(-50%); background: rgba(59, 130, 246, 0.8); color: white; padding: 6px 12px; border-radius: 4px; cursor: move; font-size: 14px; user-select: none;">
                                奖项
                            </div>
                            <div class="text-overlay" data-field="time"
                                style="position: absolute; top: 75%; left: 50%; transform: translateX(-50%); background: rgba(59, 130, 246, 0.8); color: white; padding: 6px 12px; border-radius: 4px; cursor: move; font-size: 14px; user-select: none;">
                                时间
                            </div>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #6B7280; margin-top: 8px;">
                        上传图片后，拖拽蓝色文字框到合适位置，系统将自动保存位置信息
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeUploadCertificateModal()">取消</button>
                <button class="btn btn-primary" onclick="saveCertificateTemplate()">保存模板</button>
            </div>
        </div>
    </div>

    <!-- 添加管理员模态框 -->
    <div id="addAdminModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">添加管理员</h3>
                <button class="modal-close" onclick="closeAddAdminModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="addAdminForm">
                    <div class="form-group">
                        <label class="form-label">姓名</label>
                        <input type="text" class="form-control" name="name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">手机号</label>
                        <div style="display: flex; gap: 8px;">
                            <input type="tel" class="form-control" name="phone" required placeholder="请输入手机号">
                            <button type="button" class="btn btn-secondary"
                                onclick="sendAdminVerificationCode()">发送验证码</button>
                        </div>
                    </div>
                    <div class="form-group" id="adminVerificationGroup" style="display: none;">
                        <label class="form-label">验证码</label>
                        <input type="text" class="form-control" name="verification_code" placeholder="请输入6位验证码"
                            maxlength="6">
                    </div>
                    <div class="form-group">
                        <label class="form-label">角色</label>
                        <select class="form-control" name="role" required>
                            <option value="">请选择角色</option>
                            <option value="admin">管理员</option>
                            <option value="operator">运营</option>
                            <option value="reviewer">审核</option>
                            <option value="problem_setter">出题人</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">备注</label>
                        <textarea class="form-control textarea" name="remark" rows="3"
                            placeholder="可选，添加备注信息"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeAddAdminModal()">取消</button>
                <button class="btn btn-primary" onclick="saveAdmin()">添加管理员</button>
            </div>
        </div>
    </div>

    <script>
        // 导航切换td></div></button>div>
        document.addEventListener('DOMContentLoaded', function () {
            const navItems = document.querySelectorAll('.nav-item');
            const contentSections = document.querySelectorAll('.content-section');
            const pageTitle = document.getElementById('pageTitle');

            navItems.forEach(item => {
                item.addEventListener('click', function () {
                    const targetSection = this.dataset.section;

                    // 更新导航状态
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');

                    // 更新内容区域
                    contentSections.forEach(section => section.classList.remove('active'));
                    document.getElementById(targetSection).classList.add('active');

                    // 更新页面标题
                    const titles = {
                        'events': '竞赛管理',
                        'problems': '赛题管理',
                        'registrations': '报名管理',
                        'submissions': '提交审核',
                        'scoring': '赛事结算',
                        'certificates': '发放规则',
                        'templates': '证书模板',
                        'users': '管理员账号',
                        'settings': '网站配置'
                    };
                    pageTitle.textContent = titles[targetSection] || '管理后台';
                });
            });
        });

        // 竞赛管理功能
        function openEventModal() {
            document.getElementById('eventModal').classList.add('show');
        }

        function closeEventModal() {
            document.getElementById('eventModal').classList.remove('show');
            document.getElementById('eventForm').reset();
        }

        function saveEvent() {
            const form = document.getElementById('eventForm');
            const formData = new FormData(form);

            console.log('保存竞赛:', Object.fromEntries(formData));
            alert('竞赛保存成功！');
            closeEventModal();
        }

        function editEvent(id) {
            console.log('编辑竞赛:', id);
            openEventModal();
        }

        function publishEvent(id) {
            if (confirm('确定要发布这个竞赛吗？')) {
                console.log('发布竞赛:', id);
                alert('竞赛发布成功！');
            }
        }

        function unpublishEvent(id) {
            if (confirm('确定要取消发布这个竞赛吗？')) {
                console.log('取消发布竞赛:', id);
                alert('竞赛已取消发布！');
            }
        }

        function goToRegistrations(eventId) {
            console.log('跳转到报名管理，赛事ID:', eventId);
            // 切换到报名管理页面并筛选该赛事
            document.querySelector('[data-section="registrations"]').click();
        }

        function goToProblems(eventId) {
            console.log('跳转到赛题管理，赛事ID:', eventId);
            // 切换到赛题管理页面并筛选该赛事
            document.querySelector('[data-section="problems"]').click();
        }

        // 赛题管理功能
        function openProblemModal() {
            document.getElementById('problemModal').classList.add('show');
        }

        function closeProblemModal() {
            document.getElementById('problemModal').classList.remove('show');
            document.getElementById('problemForm').reset();
        }

        function saveProblem() {
            const form = document.getElementById('problemForm');
            const formData = new FormData(form);

            console.log('保存赛题:', Object.fromEntries(formData));
            alert('赛题保存成功！');
            closeProblemModal();
        }

        function batchImportProblems() {
            console.log('批量导入赛题');
            alert('批量导入功能开发中...');
        }

        function publishProblem(id) {
            if (confirm('确定要发布这个赛题吗？')) {
                console.log('发布赛题:', id);
                alert('赛题发布成功！');
            }
        }

        function unpublishProblem(id) {
            if (confirm('确定要取消发布这个赛题吗？')) {
                console.log('取消发布赛题:', id);
                alert('赛题已取消发布！');
            }
        }

        function exportRegistrations() {
            console.log('导出报名信息');
            alert('报名信息导出中，请稍候...');
        }

        function exportScoring() {
            console.log('导出赛事结算数据');
            alert('赛事结算数据导出中，请稍候...');
        }

        function batchIssueCertificates() {
            console.log('批量发放证书');
        }

        function openTemplateModal() {
            console.log('创建证书模板');
        }

        // 赛题管理功能
        function editProblem(id) {
            console.log('编辑赛题:', id);
        }

        function viewSubmissions(id) {
            console.log('查看赛题提交:', id);
        }

        // 报名管理功能
        function removeRegistration(id) {
            if (confirm('确定要移除这个参赛者吗？')) {
                console.log('移除参赛者:', id);
                alert('参赛者已移除！');
            }
        }

        function viewRegistrationDetail(id) {
            console.log('查看报名详情:', id);
            document.getElementById('registrationDetailModal').classList.add('show');
        }

        function closeRegistrationDetailModal() {
            document.getElementById('registrationDetailModal').classList.remove('show');
        }

        // 提交审核功能
        function reviewSubmission(id) {
            console.log('审核提交:', id);
            document.getElementById('reviewModal').classList.add('show');
        }

        function closeReviewModal() {
            document.getElementById('reviewModal').classList.remove('show');
        }

        function submitReview() {
            const result = document.getElementById('reviewResult').value;
            const comment = document.getElementById('reviewComment').value;

            console.log('提交审核结果:', { result, comment });
            alert('审核结果已提交！');
            closeReviewModal();
        }

        function batchApproveSubmissions() {
            const selected = document.querySelectorAll('.submission-select:checked');
            if (selected.length === 0) {
                alert('请选择要审核的提交');
                return;
            }
            if (confirm(`确定要批量通过 ${selected.length} 个提交吗？`)) {
                console.log('批量通过提交:', selected.length);
                alert('批量审核完成！');
            }
        }

        function viewSubmissionDetail(id) {
            console.log('查看提交详情:', id);
            document.getElementById('submissionDetailModal').classList.add('show');
        }

        function closeSubmissionDetailModal() {
            document.getElementById('submissionDetailModal').classList.remove('show');
        }

        // 赛事结算功能
        function viewScoreDetail(id) {
            console.log('查看积分详情:', id);
            document.getElementById('scoreDetailModal').classList.add('show');
        }

        function closeScoreDetailModal() {
            document.getElementById('scoreDetailModal').classList.remove('show');
        }

        function adjustScore(id) {
            console.log('调整积分:', id);
            // 填充当前数据
            document.getElementById('adjustUserName').value = '张三';
            document.getElementById('adjustCurrentScore').value = '1,250';
            document.getElementById('scoreAdjustModal').classList.add('show');
        }

        function closeScoreAdjustModal() {
            document.getElementById('scoreAdjustModal').classList.remove('show');
            document.getElementById('scoreAdjustForm').reset();
        }

        function submitScoreAdjust() {
            const form = document.getElementById('scoreAdjustForm');
            const formData = new FormData(form);

            console.log('提交积分调整:', Object.fromEntries(formData));
            alert('积分调整成功！');
            closeScoreAdjustModal();
        }

        // 证书发放规则功能
        function openCertificateRuleModal() {
            document.getElementById('certificateRuleModal').classList.add('show');
        }

        function closeCertificateRuleModal() {
            document.getElementById('certificateRuleModal').classList.remove('show');
            document.getElementById('certificateRuleForm').reset();
            // 隐藏所有条件输入框
            document.getElementById('rankCondition').style.display = 'none';
            document.getElementById('scoreCondition').style.display = 'none';
            document.getElementById('completionCondition').style.display = 'none';
        }

        function saveCertificateRule() {
            const form = document.getElementById('certificateRuleForm');
            const formData = new FormData(form);

            console.log('保存证书发放规则:', Object.fromEntries(formData));
            alert('证书发放规则保存成功！');
            closeCertificateRuleModal();
        }

        function toggleConditionInput(conditionType) {
            // 隐藏所有条件输入框
            document.getElementById('rankCondition').style.display = 'none';
            document.getElementById('scoreCondition').style.display = 'none';
            document.getElementById('completionCondition').style.display = 'none';

            // 显示对应的条件输入框
            if (conditionType === 'rank') {
                document.getElementById('rankCondition').style.display = 'block';
            } else if (conditionType === 'score') {
                document.getElementById('scoreCondition').style.display = 'block';
            } else if (conditionType === 'completion') {
                document.getElementById('completionCondition').style.display = 'block';
            }
        }

        function editCertificateRule(id) {
            console.log('编辑证书发放规则:', id);
            openCertificateRuleModal();
        }

        function previewRule(id) {
            console.log('预览证书发放规则:', id);
            alert('预览证书发放规则功能开发中...');
        }

        function executeRule(id) {
            if (confirm('确定要执行这个证书发放规则吗？')) {
                console.log('执行证书发放规则:', id);
                alert('证书发放规则执行中...');
            }
        }

        // 证书模板功能
        function openTemplateModal() {
            document.getElementById('templateModal').classList.add('show');
        }

        function closeTemplateModal() {
            document.getElementById('templateModal').classList.remove('show');
            document.getElementById('templateForm').reset();
        }

        function saveTemplate() {
            const form = document.getElementById('templateForm');
            const formData = new FormData(form);

            console.log('保存证书模板:', Object.fromEntries(formData));
            alert('证书模板保存成功！');
            closeTemplateModal();
        }

        function previewTemplate(id) {
            console.log('预览模板:', id);
            alert('预览模板功能开发中...');
        }

        function editTemplate(id) {
            console.log('编辑模板:', id);
            openTemplateModal();
        }

        function duplicateTemplate(id) {
            if (confirm('确定要复制这个模板吗？')) {
                console.log('复制模板:', id);
                alert('模板复制成功！');
            }
        }

        // 全选功能
        document.addEventListener('DOMContentLoaded', function () {
            // 报名管理全选
            const selectAll = document.getElementById('selectAll');
            if (selectAll) {
                selectAll.addEventListener('change', function () {
                    const checkboxes = document.querySelectorAll('.row-select');
                    checkboxes.forEach(cb => cb.checked = this.checked);
                });
            }

            // 提交审核全选
            const selectAllSubmissions = document.getElementById('selectAllSubmissions');
            if (selectAllSubmissions) {
                selectAllSubmissions.addEventListener('change', function () {
                    const checkboxes = document.querySelectorAll('.submission-select');
                    checkboxes.forEach(cb => cb.checked = this.checked);
                });
            }

            // 证书发放全选
            const selectAllCertificates = document.getElementById('selectAllCertificates');
            if (selectAllCertificates) {
                selectAllCertificates.addEventListener('change', function () {
                    const checkboxes = document.querySelectorAll('.certificate-select');
                    checkboxes.forEach(cb => cb.checked = this.checked);
                });
            }
        });

        // 证书发放记录功能
        function openCertificateHistoryModal() {
            document.getElementById('certificateHistoryModal').classList.add('show');
        }

        function closeCertificateHistoryModal() {
            document.getElementById('certificateHistoryModal').classList.remove('show');
        }

        // 证书规则启用/关闭功能
        function enableRule(id) {
            if (confirm('确定要启用这个发放规则吗？')) {
                console.log('启用规则:', id);
                alert('发放规则已启用！');
            }
        }

        function disableRule(id) {
            if (confirm('确定要关闭这个发放规则吗？')) {
                console.log('关闭规则:', id);
                alert('发放规则已关闭！');
            }
        }

        // 上传证书图片功能
        function uploadCertificateImage(id) {
            console.log('上传证书图片:', id);
            document.getElementById('uploadCertificateModal').classList.add('show');
        }

        function closeUploadCertificateModal() {
            document.getElementById('uploadCertificateModal').classList.remove('show');
            // 重置预览
            document.getElementById('previewImage').style.display = 'none';
            document.getElementById('previewPlaceholder').style.display = 'block';
            document.getElementById('textOverlays').style.display = 'none';
        }

        function previewCertificateImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const previewImage = document.getElementById('previewImage');
                    const placeholder = document.getElementById('previewPlaceholder');
                    const textOverlays = document.getElementById('textOverlays');

                    previewImage.src = e.target.result;
                    previewImage.style.display = 'block';
                    placeholder.style.display = 'none';
                    textOverlays.style.display = 'block';

                    // 初始化拖拽功能
                    initDragAndDrop();
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function initDragAndDrop() {
            const textOverlays = document.querySelectorAll('.text-overlay');
            textOverlays.forEach(overlay => {
                let isDragging = false;
                let startX, startY, startLeft, startTop;

                overlay.addEventListener('mousedown', function (e) {
                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    const rect = overlay.getBoundingClientRect();
                    const parentRect = overlay.parentElement.getBoundingClientRect();
                    startLeft = rect.left - parentRect.left;
                    startTop = rect.top - parentRect.top;

                    overlay.style.zIndex = '1000';
                    e.preventDefault();
                });

                document.addEventListener('mousemove', function (e) {
                    if (!isDragging) return;

                    const deltaX = e.clientX - startX;
                    const deltaY = e.clientY - startY;
                    const newLeft = startLeft + deltaX;
                    const newTop = startTop + deltaY;

                    overlay.style.left = newLeft + 'px';
                    overlay.style.top = newTop + 'px';
                    overlay.style.transform = 'none';
                });

                document.addEventListener('mouseup', function () {
                    if (isDragging) {
                        isDragging = false;
                        overlay.style.zIndex = '';
                    }
                });
            });
        }

        function saveCertificateTemplate() {
            // 收集文字位置信息
            const positions = {};
            document.querySelectorAll('.text-overlay').forEach(overlay => {
                const field = overlay.dataset.field;
                positions[field] = {
                    left: overlay.style.left,
                    top: overlay.style.top
                };
            });

            console.log('保存证书模板，文字位置:', positions);
            alert('证书模板保存成功！');
            closeUploadCertificateModal();
        }

        // 管理员管理功能
        function openAddAdminModal() {
            document.getElementById('addAdminModal').classList.add('show');
        }

        function closeAddAdminModal() {
            document.getElementById('addAdminModal').classList.remove('show');
            document.getElementById('addAdminForm').reset();
            document.getElementById('adminVerificationGroup').style.display = 'none';
        }

        function sendAdminVerificationCode() {
            const phoneInput = document.querySelector('[name="phone"]');
            const phone = phoneInput.value;

            if (!phone) {
                alert('请先输入手机号');
                return;
            }

            if (!/^1[3-9]\d{9}$/.test(phone)) {
                alert('请输入正确的手机号格式');
                return;
            }

            // 显示验证码输入框
            document.getElementById('adminVerificationGroup').style.display = 'block';

            // 模拟发送验证码
            const sendBtn = event.target;
            sendBtn.disabled = true;
            sendBtn.textContent = '发送中...';

            setTimeout(() => {
                sendBtn.textContent = '60s后重发';
                let countdown = 60;
                const timer = setInterval(() => {
                    countdown--;
                    if (countdown > 0) {
                        sendBtn.textContent = `${countdown}s后重发`;
                    } else {
                        sendBtn.disabled = false;
                        sendBtn.textContent = '发送验证码';
                        clearInterval(timer);
                    }
                }, 1000);

                alert('验证码已发送到您的手机，请查收');
            }, 1000);
        }

        function saveAdmin() {
            const form = document.getElementById('addAdminForm');
            const formData = new FormData(form);

            // 验证必填字段
            const phone = formData.get('phone');
            const verificationCode = formData.get('verification_code');

            if (!verificationCode) {
                alert('请输入手机验证码');
                return;
            }

            if (verificationCode !== '123456') {
                alert('验证码错误，请重新输入');
                return;
            }

            console.log('添加管理员:', Object.fromEntries(formData));
            alert('管理员添加成功！');
            closeAddAdminModal();
        }

        function editAdmin(id) {
            console.log('编辑管理员:', id);
            openAddAdminModal();
        }

        function disableAdmin(id) {
            if (confirm('确定要禁用这个管理员账号吗？')) {
                console.log('禁用管理员:', id);
                alert('管理员账号已禁用！');
            }
        }

        function enableAdmin(id) {
            if (confirm('确定要启用这个管理员账号吗？')) {
                console.log('启用管理员:', id);
                alert('管理员账号已启用！');
            }
        }

        // 网站配置功能
        function switchConfigTab(tabName) {
            // 切换tab激活状态
            document.querySelectorAll('.config-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // 切换内容显示
            document.querySelectorAll('.config-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-config`).classList.add('active');
        }

        // Banner管理功能
        function addBannerImage() {
            console.log('添加Banner图片');
            alert('添加Banner图片功能开发中...');
        }

        function editBannerImage(id) {
            console.log('编辑Banner图片:', id);
            alert('编辑Banner图片功能开发中...');
        }

        function deleteBannerImage(id) {
            if (confirm('确定要删除这个Banner图片吗？')) {
                console.log('删除Banner图片:', id);
                alert('Banner图片已删除！');
            }
        }

        function toggleBannerStatus(id) {
            console.log('切换Banner状态:', id);
            alert('Banner状态已切换！');
        }

        // 大赛介绍功能
        function formatText(command) {
            document.execCommand(command, false, null);
        }

        function insertLink() {
            const url = prompt('请输入链接地址:');
            if (url) {
                document.execCommand('createLink', false, url);
            }
        }

        function insertImage() {
            const url = prompt('请输入图片地址:');
            if (url) {
                document.execCommand('insertImage', false, url);
            }
        }

        function saveIntroduction() {
            const content = document.querySelector('[contenteditable="true"]').innerHTML;
            console.log('保存大赛介绍:', content);
            alert('大赛介绍保存成功！');
        }

        function previewIntroduction() {
            console.log('预览大赛介绍');
            alert('预览大赛介绍功能开发中...');
        }

        // 通知公告功能
        function addNotice() {
            console.log('发布新公告');
            alert('发布新公告功能开发中...');
        }

        function editNotice(id) {
            console.log('编辑公告:', id);
            alert('编辑公告功能开发中...');
        }

        function unpublishNotice(id) {
            if (confirm('确定要下线这个公告吗？')) {
                console.log('下线公告:', id);
                alert('公告已下线！');
            }
        }

        // 常见问题功能
        function addFAQ() {
            console.log('添加问题');
            alert('添加问题功能开发中...');
        }

        function editFAQ(id) {
            console.log('编辑问题:', id);
            alert('编辑问题功能开发中...');
        }

        function hideFAQ(id) {
            if (confirm('确定要隐藏这个问题吗？')) {
                console.log('隐藏问题:', id);
                alert('问题已隐藏！');
            }
        }

        function handleLogout() {
            if (confirm('确定要退出登录吗？')) {
                window.location.href = 'login.html';
            }
        }

        // 点击模态框背景关闭
        document.addEventListener('click', function (e) {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('show');
            }
        });
    </script>
</body>

</html>